<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventure Game Skeleton</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #1a1a1a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-container {
            width: 100%;
            max-width: 600px;
            background: #2d2d2d;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .stats-panel {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 10px;
            background: #3d3d3d;
            border-radius: 8px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .tile {
            aspect-ratio: 1;
            background: #444;
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.1s, background-color 0.2s, box-shadow 0.1s;
            user-select: none;
            position: relative;
            border: 2px solid transparent;
        }

        .tile:hover {
            background: #555;
            transform: scale(1.02);
        }

        /* –ü—Ä–∏–∑—Ä–∞—á–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ */
        .tile:active {
            transform: scale(0.95);
            background: #666;
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 20px 5px rgba(255, 255, 255, 0.2), 
                        inset 0 0 10px rgba(255, 255, 255, 0.1);
            animation: ghost-pulse 1.5s infinite ease-in-out;
        }

        @keyframes ghost-pulse {
            0% { box-shadow: 0 0 15px 2px rgba(255, 255, 255, 0.2); }
            50% { box-shadow: 0 0 25px 8px rgba(255, 255, 255, 0.4); }
            100% { box-shadow: 0 0 15px 2px rgba(255, 255, 255, 0.2); }
        }

        .tile.hero { background: #3b82f6; border-color: #60a5fa; }
        .tile.gold { background: #eab308; border-color: #fde047; }
        .tile.empty { background: #333; }

        .log-panel {
            height: 100px;
            background: #1a1a1a;
            border-radius: 8px;
            padding: 10px;
            overflow-y: auto;
            font-size: 0.9rem;
            border: 1px solid #444;
        }

        .btn-super {
            width: 100%;
            padding: 12px;
            background: #8b5cf6;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 10px;
        }

        .btn-super:hover { background: #7c3aed; }
        .btn-super:disabled { background: #4b5563; cursor: not-allowed; }

        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .modal-content {
            background: #2d2d2d;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="stats-panel">
        <div>–ó–æ–ª–æ—Ç–æ: <span id="gold-count">0</span></div>
        <div>–•–æ–¥—ã: <span id="turn-count">0</span></div>
        <div>–°—É–ø–µ—Ä: <span id="super-charge">0</span>%</div>
    </div>

    <div class="grid-container" id="grid"></div>

    <div class="log-panel" id="log">
        <div>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!</div>
    </div>

    <button id="super-btn" class="btn-super" disabled>–°–£–ü–ï–†–°–ü–û–°–û–ë–ù–û–°–¢–¨</button>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <h2 class="text-2xl font-bold mb-4" id="modal-title"></h2>
        <p class="mb-6" id="modal-text"></p>
        <button onclick="location.reload()" class="bg-blue-600 px-6 py-2 rounded-lg">–ó–∞–Ω–æ–≤–æ</button>
    </div>
</div>

<script>
    // --- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ---
    const GRID_SIZE = 5;
    const INITIAL_GOLD_TARGET = 10;
    
    let state = {
        heroPos: { x: 2, y: 2 },
        gold: 0,
        turns: 0,
        superCharge: 0,
        grid: [],
        gameOver: false
    };

    const gridElement = document.getElementById('grid');
    const goldDisplay = document.getElementById('gold-count');
    const turnDisplay = document.getElementById('turn-count');
    const superDisplay = document.getElementById('super-charge');
    const logElement = document.getElementById('log');
    const superBtn = document.getElementById('super-btn');
    const modal = document.getElementById('modal');

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã ---
    function initGame() {
        state.grid = Array(GRID_SIZE).fill().map(() => Array(GRID_SIZE).fill('empty'));
        state.grid[state.heroPos.y][state.heroPos.x] = 'hero';
        spawnGold();
        render();
    }

    function spawnGold() {
        let x, y;
        do {
            x = Math.floor(Math.random() * GRID_SIZE);
            y = Math.floor(Math.random() * GRID_SIZE);
        } while (state.grid[y][x] !== 'empty');
        state.grid[y][x] = 'gold';
    }

    // --- –õ–æ–≥–∏–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ ---
    function render() {
        gridElement.innerHTML = '';
        for (let y = 0; y < GRID_SIZE; y++) {
            for (let x = 0; x < GRID_SIZE; x++) {
                const tile = document.createElement('div');
                tile.className = `tile ${state.grid[y][x]}`;
                
                // –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                if (state.grid[y][x] === 'hero') tile.textContent = 'üßô';
                if (state.grid[y][x] === 'gold') tile.textContent = 'üí∞';
                
                tile.onclick = () => handleTileClick(x, y);
                gridElement.appendChild(tile);
            }
        }

        goldDisplay.textContent = state.gold;
        turnDisplay.textContent = state.turns;
        superDisplay.textContent = state.superCharge;
        superBtn.disabled = state.superCharge < 100;
    }

    // --- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π ---
    function handleTileClick(x, y) {
        if (state.gameOver) return;

        const dx = Math.abs(x - state.heroPos.x);
        const dy = Math.abs(y - state.heroPos.y);

        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ (—Å–æ—Å–µ–¥–Ω–∏–µ –ø–ª–∏—Ç–∫–∏)
        if ((dx === 1 && dy === 0) || (dx === 0 && dy === 1)) {
            moveHero(x, y);
        } else if (dx === 0 && dy === 0) {
            addLog("–í—ã —Å—Ç–æ–∏—Ç–µ –Ω–∞ –º–µ—Å—Ç–µ.");
        } else {
            addLog("–°–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ!");
        }
    }

    function moveHero(nx, ny) {
        const target = state.grid[ny][nx];
        
        // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—É—é –ø–æ–∑–∏—Ü–∏—é
        state.grid[state.heroPos.y][state.heroPos.x] = 'empty';
        
        if (target === 'gold') {
            state.gold++;
            state.superCharge = Math.min(100, state.superCharge + 20);
            addLog("–ó–æ–ª–æ—Ç–æ —Å–æ–±—Ä–∞–Ω–æ! +20% –∫ –°—É–ø–µ—Ä—Å–∏–ª–µ.");
            spawnGold();
        }

        state.heroPos = { x: nx, y: ny };
        state.grid[ny][nx] = 'hero';
        state.turns++;

        checkWinCondition();
        render();
    }

    function addLog(message) {
        const entry = document.createElement('div');
        entry.textContent = `> ${message}`;
        logElement.prepend(entry);
    }

    function checkWinCondition() {
        if (state.gold >= INITIAL_GOLD_TARGET) {
            showEndGame("–ü–æ–±–µ–¥–∞!", `–í—ã —Å–æ–±—Ä–∞–ª–∏ ${state.gold} –∑–æ–ª–æ—Ç—ã—Ö –º–æ–Ω–µ—Ç –∑–∞ ${state.turns} —Ö–æ–¥–æ–≤.`);
        }
    }

    function showEndGame(title, text) {
        state.gameOver = true;
        document.getElementById('modal-title').textContent = title;
        document.getElementById('modal-text').textContent = text;
        modal.style.display = 'flex';
    }

    // --- –°—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å ---
    superBtn.onclick = () => {
        if (state.superCharge >= 100) {
            state.superCharge = 0;
            addLog("–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ê –°–£–ü–ï–†–°–ü–û–°–û–ë–ù–û–°–¢–¨: –ú–∞–≥–Ω–∏—Ç –∑–æ–ª–æ—Ç–∞!");
            // –ú–µ—Ö–∞–Ω–∏–∫–∞: —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å—ë –∑–æ–ª–æ—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ (–≤ —Å–∫–µ–ª–µ—Ç–µ —ç—Ç–æ –æ–¥–Ω–æ –∑–æ–ª–æ—Ç–æ)
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    if (state.grid[y][x] === 'gold') {
                        state.gold++;
                        state.grid[y][x] = 'empty';
                        spawnGold();
                    }
                }
            }
            render();
        }
    };

    window.onload = initGame;
</script>

</body>
</html>
